<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.yang.mapper.OrderMapper">

    <resultMap id="OrderMap" type="com.yang.pojo.GuetOrder" autoMapping="true">
        <id property="id" column="order_id"/>
        <result property="userId" column="user_id"/>
        <result property="customerId" column="customer_id"/>
        <result property="num" column="order_num"/>
        <result property="name" column="order_name"/>
        <result property="number" column="order_number"/>
        <result property="price" column="order_price"/>
        <result property="total" column="order_total"/>
        <result property="status" column="order_status"/>
        <result property="address" column="order_address"/>
        <result property="createTime" column="create_time"/>
        <result property="payment" column="order_payment"/>
        <result property="shipping" column="order_shipping"/>
        <result property="citi" column="order_citi"/>
        <result property="desc" column="description"/>
        <result property="phone" column="order_phone"/>
        <result property="person" column="order_person"/>
    </resultMap>

    <sql id="columns">
        order_id, user_id, customer_id, order_num, order_name, order_number,
    order_price, order_total, order_status, order_address, create_time,
    order_payment, order_shipping, order_citi, description, order_phone, order_person
    </sql>

    <!-- 查询所有订单 -->
    <select id="selectAll" resultMap="OrderMap">
        select <include refid="columns"/> from guet_order
    </select>

    <!-- 根据ID查询 -->
    <select id="selectById" resultMap="OrderMap">
        select <include refid="columns"/> from guet_order where order_id = #{id}
    </select>

    <!-- 模糊查询 -->
    <select id="selectByCondition" resultMap="OrderMap">
        select <include refid="columns"/> from guet_order
        <where>
            <if test="name != null and name != ''">
                and order_name like concat('%', #{name}, '%')
            </if>
            <if test="num != null and num != ''">
                and order_num like concat('%', #{num}, '%')
            </if>
            <if test="status != null">
                and order_status = #{status}
            </if>
            <if test="customerId != null">
                and customer_id = #{customerId}
            </if>
        </where>
    </select>

    <!-- 根据用户ID查询订单 -->
    <select id="selectByUserId" resultMap="OrderMap">
        select <include refid="columns"/> from guet_order where user_id = #{userId}
    </select>

    <!-- 新增订单 -->
    <insert id="insert" useGeneratedKeys="true" keyProperty="id">
        insert into guet_order (
            user_id, customer_id, order_num, order_name, order_number,
            order_price, order_total, order_status, order_address, create_time,
            order_payment, order_shipping, order_citi, description, order_phone, order_person
        ) values (
                     #{userId}, #{customerId}, #{num}, #{name}, #{number},
                     #{price}, #{total}, #{status}, #{address}, #{createTime},
                     #{payment}, #{shipping}, #{citi}, #{desc}, #{phone}, #{person}
                 )
    </insert>

    <!-- 更新订单 -->
    <update id="update">
        update guet_order
        <set>
            <if test="userId != null">user_id = #{userId},</if>
            <if test="customerId != null">customer_id = #{customerId},</if>
            <if test="num != null">order_num = #{num},</if>
            <if test="name != null">order_name = #{name},</if>
            <if test="number != null">order_number = #{number},</if>
            <if test="price != null">order_price = #{price},</if>
            <if test="total != null">order_total = #{total},</if>
            <if test="status != null">order_status = #{status},</if>
            <if test="address != null">order_address = #{address},</if>
            <if test="payment != null">order_payment = #{payment},</if>
            <if test="shipping != null">order_shipping = #{shipping},</if>
            <if test="citi != null">order_citi = #{citi},</if>
            <if test="desc != null">description = #{desc},</if>
            <if test="phone != null">order_phone = #{phone},</if>
            <if test="person != null">order_person = #{person},</if>
        </set>
        where order_id = #{id}
    </update>

    <!-- 删除订单 -->
    <delete id="deleteById">
        delete from guet_order where order_id = #{id}
    </delete>


</mapper>